<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Online Minimore Store</title>
  <link rel="icon" href="https://lh3.googleUserContent.com/d/1n6WREaza8QhZFQFLvpZYD0wzYXSwK0aF" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      font-family: sans-serif;
      display: flex; /* ‡πÉ‡∏ä‡πâ Flexbox ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ layout */
      flex-direction: column; /* ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á */
    }
    .controls { /* ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° */
      padding: 10px;
      background-color: #f0f0f0;
      border-bottom: 1px solid #ccc;
      text-align: center;
      flex-shrink: 0; /* ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏î */
    }
    .controls button {
      padding: 8px 16px;
      font-size: 16px;
      margin: 0 5px;
      cursor: pointer;
    }
    .iframe-container {
      position: relative;
      width: 100%;
      flex-grow: 1; /* ‡πÉ‡∏´‡πâ iframe ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏ï‡πá‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ */
    }
    iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
    .loader {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 1.2rem;
      color: #666;
      z-index: 10;
    }
  </style>
</head>
<body>
  
  <div class="controls">
    <button onclick="triggerIframePrint()">üìÑ ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</button>
    <button onclick="triggerIframeDownload()">üñºÔ∏è ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</button>
  </div>

  <div class="iframe-container">
    <div class="loader" id="loader">Loading app...</div>
    <iframe
      id="app-iframe" 
      src="https://script.google.com/macros/s/AKfycbwzP27FIJSjb1akQKgkrzcmzqEQg3TLRhNUlUx36VO1PVQLwXRMsMXeRnUMHiVGwcos/exec"
      title="M-IT Support"
      allowfullscreen>
    </iframe>
  </div>
  
  <script>
    const iframe = document.getElementById('app-iframe');
    const loader = document.getElementById('loader');
    const targetOrigin = 'https://script.google.com'; // ‡∏£‡∏∞‡∏ö‡∏∏‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡∏Ç‡∏≠‡∏á iframe ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

    // ‡∏ã‡πà‡∏≠‡∏ô Loader ‡πÄ‡∏°‡∏∑‡πà‡∏≠ iframe ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
    iframe.onload = function () {
      if (loader) loader.style.display = 'none';
    };

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á "‡∏û‡∏¥‡∏°‡∏û‡πå" ‡πÑ‡∏õ‡∏¢‡∏±‡∏á iframe
    function triggerIframePrint() {
      // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° 'print-invoice' ‡πÑ‡∏õ‡∏¢‡∏±‡∏á iframe
      iframe.contentWindow.postMessage('print-invoice', targetOrigin);
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á "‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î" ‡πÑ‡∏õ‡∏¢‡∏±‡∏á iframe
    function triggerIframeDownload() {
      // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° 'download-invoice' ‡πÑ‡∏õ‡∏¢‡∏±‡∏á iframe
      iframe.contentWindow.postMessage('download-invoice', targetOrigin);
    }
  </script>

</body>
</html>
