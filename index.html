<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="Minimore" />
    <link rel="apple-touch-icon" href="https://lh3.googleUserContent.com/d/1n6WREaza8QhZFQFLvpZYD0wzYXSwK0aF" />
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#4A90E2" />

    <title>Online Minimore Store</title>
    <link rel="icon" href="https://lh3.googleUserContent.com/d/1n6WREaza8QhZFQFLvpZYD0wzYXSwK0aF" />

<style>
    #chrome-warning {
        display: none; /* ซ่อนไว้ก่อนเป็นค่าเริ่มต้น */
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(255, 255, 255, 0.95);
        z-index: 9999;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 20px;
        box-sizing: border-box;
        font-family: Arial, sans-serif;
    }
    #chrome-warning img {
        width: 70px;
        margin-bottom: 20px;
    }
    #chrome-warning h2 {
        font-size: 1.4rem;
        color: #333;
    }
    #chrome-warning p {
        color: #555;
        margin-bottom: 30px;
    }
    .action-button {
        display: inline-block;
        padding: 12px 25px;
        margin: 5px;
        border-radius: 8px;
        text-decoration: none;
        color: white;
        font-weight: bold;
        cursor: pointer;
        border: none;
        font-size: 1rem;
    }
    #open-in-chrome-btn {
        background-color: #4285F4; /* สีน้ำเงิน Google */
    }
    #copy-link-btn {
        background-color: #0F9D58; /* สีเขียว Google */
    }
</style>
</head>
<body>

    <div class="iframe-container">
        <div class="loader" id="loader"></div>
        <iframe
            src="https://script.google.com/macros/s/AKfycbw1nBYxr63UN7iAx_wpSOlbCev54l9ryaCZ_bSR_0vFgBkSglOq3fqVX5aeCluaCNkF/exec"
            title="M-IT Support"
            allowfullscreen>
        </iframe>
    </div>

    <div id="chrome-warning">
        <img src="https://upload.wikimedia.org/wikipedia/commons/a/a5/Google_Chrome_icon_%28September_2014%29.svg" alt="Google Chrome Logo">
        <h2>ต้องใช้เบราว์เซอร์ Google Chrome เท่านั้น</h2>
        <p>
            เพื่อบันทึกใบเสร็จการซื้อ<br>กรุณาดำเนินการต่อใน Google Chrome
        </p>
        <div>
            <a href="#" id="open-in-chrome-btn" class="action-button">เปิดใน Chrome</a>
            
            <button id="copy-link-btn" class="action-button">คัดลอกลิงก์</button>
        </div>
        <p id="copy-feedback" style="margin-top:20px; color:green; font-weight:bold;"></p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const userAgent = navigator.userAgent;
            // ตรวจสอบว่าเป็น Chrome และไม่ใช่เบราว์เซอร์อื่นที่ใช้ Engine เดียวกันเช่น Edge
            const isChrome = userAgent.includes("Chrome") && !userAgent.includes("Edg");
        
            const warningBox = document.getElementById('chrome-warning');
        
            // ถ้าไม่ใช่ Chrome ให้แสดงกล่องข้อความ
            if (!isChrome) {
                warningBox.style.display = 'flex';
        
                const currentUrl = window.location.href;
                const openBtn = document.getElementById('open-in-chrome-btn');
                const copyBtn = document.getElementById('copy-link-btn');
                const feedback = document.getElementById('copy-feedback');
        
                // 1. ตั้งค่าลิงก์สำหรับปุ่ม "เปิดใน Chrome" (สำหรับมือถือ)
                // ใช้ URL Scheme ของ Chrome
                openBtn.href = `googlechrome://navigate?url=${encodeURIComponent(currentUrl)}`;
        
                // 2. ตั้งค่าการทำงานของปุ่ม "คัดลอกลิงก์"
                copyBtn.addEventListener('click', () => {
                    navigator.clipboard.writeText(currentUrl).then(() => {
                        feedback.textContent = 'คัดลอกลิงก์สำเร็จแล้ว!';
                        copyBtn.textContent = 'คัดลอกแล้ว!';
                        setTimeout(() => {
                            feedback.textContent = '';
                            copyBtn.textContent = 'คัดลอกลิงก์';
                        }, 3000);
                    }).catch(err => {
                        feedback.textContent = 'เกิดข้อผิดพลาดในการคัดลอก';
                        console.error('Copy failed', err);
                    });
                });
            }
        });
    </script>
</body>
</html>
